<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>{{ table_name }}</h1>

        <!-- Date Range Filter Form -->
        <div class="card mb-4">
            <div class="card-body">
                <form method="GET" class="row g-3 align-items-end">
                    <div class="col-md-4">
                        <label for="from_date" class="form-label">From Date:</label>
                        <input type="date" class="form-control" id="from_date" name="from_date" value="{{ request.args.get('from_date', '') }}">
                    </div>
                    <div class="col-md-4">
                        <label for="to_date" class="form-label">To Date:</label>
                        <input type="date" class="form-control" id="to_date" name="to_date" value="{{ request.args.get('to_date', '') }}">
                    </div>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-primary">Filter</button>
                        <a href="{{ url_for('view_raw_material') }}" class="btn btn-secondary">Reset</a>
                    </div>
                </form>
            </div>
        </div>

        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="alert alert-info">
                    <ul class="mb-0">
                        {% for message in messages %}
                            <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        {% endwith %}

        <nav class="nav nav-pills mb-4">
            <a class="nav-link" href="{{ url_for('view_packing', date=packing_data[0].pack_date if packing_data else '') }}">View Packing</a>
            <a class="nav-link" href="{{ url_for('view_filling', date=filling_data[0].pack_date if filling_data else '') }}">View Filling</a>
            <a class="nav-link" href="{{ url_for('view_production', date=production_data[0].pack_date if production_data else '') }}">View Production</a>
            <a class="nav-link" href="{{ url_for('view_usage', date=usage_data[0].pack_date if usage_data else '') }}">View Usage</a>
            <a class="nav-link active" href="{{ url_for('view_raw_material', date=raw_material_data[0].pack_date if raw_material_data else '') }}">View Raw Material</a>
        </nav>

        <!-- Packing Table -->
        <div class="card mb-4">
            <div class="card-header">
                <h2 class="mb-0">Packing</h2>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>Pack Date</th>
                                <th>FG Code</th>
                                <th>Description</th>
                                <th>Unit5</th>
                                <th>Total KG</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in packing_data %}
                                <tr>
                                    <td>{{ row.pack_date }}</td>
                                    <td>{{ row.fg_code }}</td>
                                    <td>{{ row.description }}</td>
                                    <td>{{ row.unit5 }}</td>
                                    <td>{{ row.total_kg }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Other tables with the same card styling -->
        {% for section in [
            ('Filling', filling_data, ['pack_date', 'fill_code', 'fill_desc', 'total_kg']),
            ('Production', production_data, ['pack_date', 'prod_code', 'description', 'batches', 'total_kg']),
            ('Usage', usage_data, ['pack_date', 'prod_code', 'raw_material', 'usage', 'percentage']),
            ('Raw Material Report', raw_material_data, ['raw_material', 'meat_required'])
        ] %}
        <div class="card mb-4">
            <div class="card-header">
                <h2 class="mb-0">{{ section[0] }}</h2>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                {% for column in section[2] %}
                                <th>{{ column|replace('_', ' ')|title }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in section[1] %}
                                <tr>
                                    {% for column in section[2] %}
                                    <td>
                                        {% if column == 'percentage' %}
                                            {{ row[column] }}%
                                        {% else %}
                                            {{ row[column] }}
                                        {% endif %}
                                    </td>
                                    {% endfor %}
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% endfor %}

        <div class="mb-4">
            <a href="{{ url_for('index') }}" class="btn btn-primary">Back to Home</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>